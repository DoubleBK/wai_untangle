## 📋 개요

이 지침은 게임 MVP 문서를 분석하여 시스템을 세분화하고, LLM 기반 바이브코딩에 최적화된 PRD 및 GDD 문서를 생성하기 위한 통합 프레임워크입니다.

### 🎯 목적

- MVP 문서에서 **누락 없이** 시스템을 도출
- 도출된 시스템을 LLM이 **정확히 이해하고 코드화**할 수 있도록 구조화
- 실행 가능한 PRD와 GDD 문서 자동 생성

### 🔄 전체 흐름

```
[MVP 문서 분석] → [시스템 세분화] → [시스템 간 연결 구조화] → [바이브코딩 최적화 PRD/GDD 생성] → [코드 스켈레톤 생성]
```

### 🧠 요청에 따른 추가 액션 

### Case1. PRD 문서 작성 요청 

파악된 MVP 요소에 따라 아래의 형태가 반드시 포함된 프로젝트 개요 문서 제작 :

- 씬 구조
- 전체 시스템 리스트 
- 각 시스템의 책임 요소 및 연관 관계 
- 문서 하나에서 확인 가능한 수준으로 정리

###  Case2. GDD 문서 작성 요청 

PRD 문서를 바탕으로 GDD가 파생될 수 있도록 구체화 된 문서로 제작 하되 아래의 명세가 없다면 PRD 문서에 보강 하도록  :

- **전체 시스템 구조** – 시스템별 간략한 기능 예제나 함수 명세 요약 필요    
- **입력/출력 명세** – 입력 이벤트에 따른 상태 변화 흐름 구체화 필요    
- **리소스 및 데이터 테이블** – 각 테이블의 필드 내용을 좀 더 구체적으로 기술하면 GDD와 연결 용이
- 상기의 내용이 PRD에 없는 경우 질문을 통해 코멘트 추가 여부 확인 후 보강 할 수 있도록 
- 문서는 토큰 제한으로 잘리는 일 없도록 단위 문서 하나씩 생성 하며, 진행 여부를 확인 받도록 

---

## 🔍 문서 분석 및 시스템 도출 과정

### Step 1: MVP 문서 입력 받기

MVP 문서를 분석하기 전, 다음 정보를 확인합니다:

- 게임의 장르/타입
- 대상 플랫폼
- 사용할 엔진/프레임워크
- 핵심 기능 목표

### Step 2: 필수 정보 확인 및 보완

분석에 필요한 정보가 누락된 경우, 다음 항목을 질문으로 보완합니다:

| 카테고리  | 필수 확인 항목     | 질문 예시                            |
| ----- | ------------ | -------------------------------- |
| 기술 구성 | 게임 시점(2D/3D) | "이 게임은 2D인가요, 3D인가요?"            |
| 시각 요소 | 카메라 방식       | "카메라 시점은 어떤가요? (탑다운/쿼터뷰/횡스크롤 등)" |
| 조작성   | 입력 방식        | "직접 조작 방식은 무엇인가요? (클릭, 드래그 등)"   |
| 수익 구조 | 과금/광고 여부     | "광고 또는 과금 요소가 포함되나요?"            |
| 콘텐츠   | 수집 요소        | "수집 가능한 콘텐츠가 존재하나요?"             |
| 보상    | 보상 메커니즘      | "보상 방식은 어떤가요? (광고 보상, 일반 보상 등)"  |
| 성장    | 성장 시스템       | "성장 방식이 존재하나요? (업그레이드, 진화 등)"    |
| 씬 구성  | 주요 씬 구조      | "게임의 주요 화면 구성은 어떻게 되나요?"         |

### Step 3: 시스템 리스트 도출

#### 시스템 도출 기준표

| 분석 영역        | 세부 항목        | 도출 시스템 예시                    |
| ------------ | ------------ | ---------------------------- |
| **게임 실행 흐름** | 시작 → 진행 → 종료 | 스플래시, 계정, 버전 체크, 씬 로딩, 결과 처리 |
| **핵심 루프**    | 주요 게임플레이     | 전투, 퍼즐, 수집, 육성, 탐험           |
| **콘텐츠 구조**   | 수집/획득 요소     | 캐릭터, 아이템, 스테이지, 퀘스트          |
| **경제 시스템**   | 자원 흐름        | 재화, 상점, 광고, IAP, 보상          |
| **성장 요소**    | 발전/진화        | 강화, 진화, 레벨업, 스킬              |
| **UI/UX**    | 인터페이스        | 메뉴, HUD, 팝업, 알림              |
| **지원 시스템**   | 서비스 운영       | 로그인, 세이브, 설정, 튜토리얼, 업적       |
| **씬 구조**     | 화면 전환        | 씬 관리, 전환 이펙트, 로딩             |


#### 씬 기반 시스템 구조 도출

씬 구조를 기준으로 시스템을 정리하여 게임 흐름에 따른 시스템의 작동 시점과 연결성을 명확히 합니다:

```
[게임 시스템 구조]
├─ Scene: 스플래시/로딩 (SYS_001~)
│  ├─ 스플래시 시스템
│  ├─ 버전 체크 시스템
│  ├─ 리소스 로딩 시스템
├─ Scene: 로그인/계정 (SYS_004~) 
│  ├─ 계정 연동 시스템
│  ├─ 데이터 동기화 시스템
├─ Scene: 홈/로비 (SYS_006~)
│  ├─ UI 내비게이션 시스템
│  ├─ 설정 시스템
│  ├─ 상점 시스템
├─ Scene: 준비/선택 (SYS_010~)
│  ├─ 캐릭터/스테이지 선택 시스템
│  ├─ 팀 구성 시스템
├─ Scene: 인게임 (SYS_015~)
│  ├─ 코어 게임플레이 시스템
│  ├─ AI 시스템
│  ├─ 이펙트 시스템
│  ├─ HUD 시스템
├─ Scene: 결과 (SYS_025~)
│  ├─ 결과 계산 시스템
│  ├─ 보상 지급 시스템
│  ├─ 광고 보상 시스템
```

#### 시스템 간 의존성 매핑

시스템 간 의존성 및 데이터 흐름을 명확히 하여 코드 구현에 필요한 연결점을 제공합니다:

```
[의존성 맵]
상점 시스템 → 재화 관리 시스템 → 데이터 저장 시스템
강화 시스템 → 아이템 관리 시스템 → 데이터 저장 시스템
로그인 시스템 → 계정 관리 시스템 → 서버 통신 시스템
```

### Step 4: 시스템 구조화 및 세부 명세 문서화

도출된 각 시스템에 대해 바이브코딩에 최적화된 구조로 세부 명세를 작성합니다.

---

## 🔧 바이브코딩을 위한 PRD 최적화 요소

각 시스템의 PRD 문서에는 다음 요소를 반드시 포함시켜 LLM이 코드를 정확히 생성할 수 있도록 합니다:

### 1. 시스템 콘텍스트 요약 블록

모든 시스템 명세 시작 부분에 게임 내 역할과 맥락을 명확히 설명합니다:

```markdown
### 🧭 시스템 콘텍스트 요약
- 시스템명: 무기 강화 시스템
- 게임 내 위치: 성장 루프 중간 노드
- 소속 씬(Scene): 장비 관리 화면
- 입력 유형: UI 버튼 클릭
- 반복 여부: 무한 반복 가능
- 실패 조건: 재화 부족 / 최대 레벨 도달
- 연동 시스템: 재화 관리 / 광고 시청 / IAP
```

### 2. 입력-처리-출력 구조화

각 기능을 명확한 입력-처리-출력 패턴으로 정의합니다:

```markdown
### 강화 시도 기능
[입력] 무기 강화 버튼(btn_upgrade) 클릭
[처리] 
1. 필요 재화 계산
2. 보유 재화 확인
3. 강화 성공률 계산
4. 랜덤 확률 적용
[출력] 
- 성공 시: 무기 스탯 증가, 성공 이펙트, TXT_UPGRADE_SUCCESS 메시지
- 실패 시: 재화만 소모, 실패 이펙트, TXT_UPGRADE_FAIL 메시지
- 재화 부족: 부족 안내 팝업, 재화 획득 유도 버튼 활성화
```

### 3. 함수 단위 명세

각 기능을 함수 수준으로 세분화하여 정의합니다 (의사 코드 정도로 간결하게 작성):

```markdown
### 함수 명세: 강화 시도
- 함수명: `attemptWeaponUpgrade()`
- 입력 파라미터:
  - `weaponId: string` - 강화할 무기 고유 ID
  - `currentLevel: int` - 현재 무기 레벨
- 반환값:
  - `UpgradeResult` enum {SUCCESS, FAIL, NO_RESOURCE}
- 내부 처리:
```

```markdown
슈도 코드 수준으로 정리 하여 커서를 이용한 바이브 코딩 과정에서 구체화 할 수 있도록 합니다. 
```

### 4. 클래스 책임 명세

기능이 속한 클래스와 책임 범위를 명확히 정의합니다 (의사 코드 정도로 간결하게 작성):

```markdown
### 클래스 명세
- 클래스명: `WeaponUpgradeManager`
- 유형: `MonoBehaviour`
- 책임 범위: "무기 강화 UI 상호작용, 강화 로직, 결과 처리 전담"
- 주요 필드:
  - `private Weapon selectedWeapon;`
  - `private int upgradeGoldAmount;`
  - `private Button upgradeButton;`
- 주요 메서드:
  - `public void SelectWeapon(Weapon weapon)`
  - `public UpgradeResult AttemptUpgrade()`
  - `private void UpdateUI()`
```

### 5. UI 이벤트 트리거 정의

유저 입력과 UI 이벤트 처리 방법을 명확히 기술합니다 (의사 코드 정도로 간결하게 작성):

```markdown
### UI 이벤트 처리
- 입력 요소: `btn_upgrade` (강화 버튼)
- 이벤트 유형: `Click`
- 이벤트 핸들러: `OnUpgradeButtonClick()`
- 상태별 UI 변화:
  - 재화 충분: 버튼 활성화, 정상 색상
  - 재화 부족: 버튼 비활성화, 회색 처리
  - 최대 레벨: 버튼 비활성화, "MAX" 텍스트로 변경
```

### 6. 상태 흐름 및 조건 분기

기능의 상태 변화와 조건 분기를 명확히 정의합니다:

````markdown
### 상태 흐름
```mermaid
stateDiagram
    [*] --> 대기
    대기 --> 강화시도: 강화버튼 클릭
    강화시도 --> 재화부족: if (gold < required)
    강화시도 --> 강화진행: if (gold >= required)
    강화진행 --> 강화성공: if (random < successRate)
    강화진행 --> 강화실패: if (random >= successRate)
    강화성공 --> 결과표시
    강화실패 --> 결과표시
    재화부족 --> 재화획득유도
    결과표시 --> 대기
    재화획득유도 --> 대기
````

### 7. 리소스 및 데이터 정의

필요한 리소스와 데이터 구조는 요청이 없다면 별도로 정의 하지 않습니다. 

```markdown
### 리소스 요구사항
- 스프라이트/이미지:
  - `img_weapon_upgrade_button`: 강화 버튼 이미지
  - `img_upgrade_success_effect`: 성공 이펙트 스프라이트 시트
  - `img_upgrade_fail_effect`: 실패 이펙트 스프라이트 시트
- 사운드:
  - `sfx_upgrade_click`: 버튼 클릭 효과음
  - `sfx_upgrade_success`: 강화 성공 효과음
  - `sfx_upgrade_fail`: 강화 실패 효과음
- 데이터 테이블:
  - `tbl_upgrade_cost`: 레벨별 강화 비용 테이블
  - `tbl_success_rate`: 레벨별 성공 확률 테이블
```

### 8. 텍스트 ID 정의

UI 텍스트의 ID 체계를 명확히 정의하여 다국어 지원과 텍스트 변경에 대한 대응은 요청이 없다면 별도로 정의 하지 않습니다. 

```markdown
### 텍스트 ID 정의
| 요소 | Text ID | 실제 문구 |
|------|---------|----------|
| 강화 버튼 | TXT_BTN_UPGRADE | "강화하기" |
| 성공 메시지 | TXT_UPGRADE_SUCCESS | "강화에 성공했습니다!" |
| 실패 메시지 | TXT_UPGRADE_FAIL | "강화에 실패했습니다." |
| 재화 부족 | TXT_RESOURCE_LACK | "골드가 부족합니다." |
```

### 9. LLM 최적화 주석

코드 생성을 지원하기 위한 LLM 주석을 추가합니다:

```markdown
### LLM 최적화 주석
// LLM 설명용: 강화 버튼은 재화가 부족하면 비활성화되고, 실패 시 광고 버튼을 노출함
// LLM 설명용: 강화 성공/실패 시 화면 중앙에 크게 텍스트 표시 후 1.5초 이후 자동 페이드 아웃
// LLM 설명용: 강화 성공 확률은 10레벨부터 급격히 감소하는 로그 곡선을 따름
```

### 10. 시스템 간 연동 정의

다른 시스템과의 연동 지점을 명확히 정의합니다 (의사 코드 정도로 간결하게 작성) :

```markdown
### 시스템 연동 지점
- 재화 시스템 연동:
  - 호출 메서드: `CurrencyManager.ConsumeCurrency(CurrencyType.GOLD, amount)`
  - 확인 메서드: `CurrencyManager.HasEnoughCurrency(CurrencyType.GOLD, amount)`
- 데이터 저장 시스템 연동:
  - 저장 호출: `SaveManager.SaveWeaponData(weaponData)`
  - 데이터 로드: `weaponData = SaveManager.LoadWeaponData()`
- 광고 시스템 연동:
  - 광고 요청: `AdManager.ShowRewardedAd(AdRewardType.UPGRADE_RETRY, OnAdCompleted)`
```

---